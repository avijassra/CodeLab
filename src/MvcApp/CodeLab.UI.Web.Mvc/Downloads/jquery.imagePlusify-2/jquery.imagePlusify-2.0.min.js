/*!
* jquery.imagePlusify-2.0.js
* jQuery image plusify plugin
* Version 2.0 (24-Feb-2012)
* @requires jQuery v1.6.2 or later
*
* Examples at: http://jassra.com/jquery/imageplusify
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
*
*/
var plusifier=function(){var a=null,e=[],c=[],b=0,f=null,h=false,d=null,g=function(d,a){b>0&&$.each(c,function(e,c){if(c!=null)if(c.cacheIndex==d){if(a==null||a=="undefined"){c.active=false;b-=1}else c.mouseEnter=a;return}})};addModifyAnimatingItems=function(a){addToList=true;c.length>0&&$.each(c,function(d,c){if(c!=null)if(c.cacheIndex==a.cacheIndex){c.mouseEnter=a.mouseEnter;c.active=a.active;addToList=false;b+=1;return}});if(addToList){c.push(a);b+=1}};var i=function(){if(b>0)if(f==null)f=setInterval(function(){$.each(c,function(h,d){if(d.active){obj=e[d.cacheIndex];obj.elem.unbind("click");d.mouseEnter&&a.onClick&&obj.elem.bind("click",{id:obj.album.id,name:obj.album.name,imgs:obj.album.imgs,callback:a.onClick},j);if(obj.topImg!=null){if(d.mouseEnter){tx=obj.topImg.position().left-1;bx=obj.botImg.position().left+1}else{tx=obj.topImg.position().left+1;bx=obj.botImg.position().left-1}slideTo=obj.midImg?a.slideBy:a.slideBy/2;if(obj.topImgOrigPosit.left-slideTo<tx&&d.mouseEnter||tx<=obj.topImgOrigPosit.left&&!d.mouseEnter){obj.topImg.css({left:tx+"px"});obj.botImg.css({left:bx+"px"})}else{g(d.cacheIndex);if(b<=0){clearInterval(f);f=null;c=[]}}}}})},10)},j=function(a){a.data.callback&&a.data.callback(a.data.id,a.data.name,a.data.imgs)};return{uniqid:function(){var a=new Date;return a.getTime()},setOptions:function(b){if(!a)a=b},cacheCount:function(){return e.length},newCache:function(a){e.push(a)},cacheByIndex:function(a){return e[a]},isArray:function(a){return!a||a==null||a=="undefined"?false:a.constructor.toString().indexOf("Array")==-1?false:a.length>0?true:false},getAnimationDetails:function(){if(d==null&&!h){h=true;if(a.cssAnimationTurnedOn){domPrefixes="Webkit Moz O ms Khtml".split(" "),$textElem=$("<div />").attr("id",plusifier.uniqid()).appendTo($("body"));if($textElem[0].style.animationName)d={support:true,prefix:""};if(d==null)for(var b=0;b<domPrefixes.length;b++)if($textElem[0].style[domPrefixes[b]+"AnimationName"]!==undefined){d={support:true,prefix:"-"+domPrefixes[b].toLowerCase()+"-"};break}$textElem.remove()}}return d},onMouseEnter:function(c){$albPics=$("div.jqAP["+dataPlusifyCacheIndex+"="+c.data.id+"]");a.borderOnMouseOver&&$("div.jqIC",$albPics).css("border",a.borderOnMouseOver);if(plusifier.getAnimationDetails()==null){g(c.data.id);initializeTimer=b<=0;addModifyAnimatingItems({cacheIndex:c.data.id,mouseEnter:true,active:true});initializeTimer&&i(c.data.id,true)}else{obj=e[c.data.id];$("div.jqIC",$albPics).addClass("fanOut");$albPics.bind("click",{id:obj.album.id,name:obj.album.name,imgs:obj.album.imgs,callback:a.onClick},j)}},onMouserLeave:function(c){$albPics=$("div.jqAP["+dataPlusifyCacheIndex+"="+c.data.id+"]");a.border&&$("div.jqIC",$albPics).css("border",a.border);if(plusifier.getAnimationDetails()==null){g(c.data.id);initializeTimer=b<=0;addModifyAnimatingItems({cacheIndex:c.data.id,mouseEnter:false,active:true});initializeTimer&&i(c.data.id,false)}else{$("div.jqIC",$albPics).removeClass("fanOut");$albPics.unbind("click")}}}}();(function(a){a.fn.extend({imagePlusify:function(d){albContExt="_albCont";imgContExt="_imgCont";lblExt="_lbl";divIdExt="_div_";imgIdExt="img_";dataPlusifyCacheIndex="data-plusify-cacheIndex";albumClass="albums";plusifyStyle="plusifyStyle";imgDivClass="imgholder";labelClass="labelText";var b={border:"1px solid gray",borderOnMouseOver:"1px solid black",padding:"5px",backgroundColor:"#fff",displayLabel:false,labelColor:"#000",randomize:true,margin:"30px",width:"200px",height:"200px",slideBy:30,rotateBy:7,cssAnimationTurnedOn:true,source:null,onClick:null};a.extend(b,d);var c=[];if(!b.source)return;if(plusifier.isArray(b.source)&&typeof b.source[0]=="string")c.push({id:plusifier.uniqid(),imgs:b.source});else if(b.source.Id&&plusifier.isArray(b.source.Images))c.push({id:b.source.Id,imgs:b.source.Images});else if(plusifier.isArray(b.source))for(index=0;index<b.source.length;index++)if(typeof b.source[index]==="object"&&b.source[index].Id&&plusifier.isArray(b.source[index].Images)){albName=b.source[index].Name;c.push({id:b.source[index].Id,name:albName?albName:"",imgs:b.source[index].Images})}if(!plusifier.isArray(c))return;$selector=a(this);if($selector.length>0){plusifier.setOptions({border:b.border,borderOnMouseOver:b.borderOnMouseOver,slideBy:b.slideBy,onClick:b.onClick,cssAnimationTurnedOn:b.cssAnimationTurnedOn});paddingVal=parseInt(b.padding.replace("px",""));containerWidth=parseInt(b.width.replace("px",""));containerHeight=parseInt(b.height.replace("px",""));imgWidth=containerWidth-2*paddingVal;imgHeight=containerHeight-2*paddingVal;broserAnim=plusifier.getAnimationDetails();if(a("#"+plusifyStyle).length==0){$head=a("head");$head.append('<style id="'+plusifyStyle+'"> div.'+albumClass+"{position: relative; float: left;  } div."+albumClass+" div."+labelClass+"{ position: absolute; width: "+containerWidth+"px; bottom: 0px; margin:auto; z-index: 9999; text-align: center; font-weight:bold; color: "+b.labelColor+";} div."+albumClass+" div."+imgDivClass+" {position: relative; background-color: "+b.backgroundColor+"; padding: "+b.padding+"; border: "+b.border+"; "+(broserAnim&&broserAnim.support?broserAnim.prefix+"transition:all 1s ease-in-out;":"")+"} </style>");broserAnim&&broserAnim.support&&a("#"+plusifyStyle).append("div.topPic.fanOut {"+broserAnim.prefix+"transform: translateX(-"+b.slideBy+"px) translateY(10px) scale(1.1, 1.1) rotate(-"+b.rotateBy+"deg); } div."+albumClass+" div.middlePic.fanOut {"+broserAnim.prefix+"transform: scale(1.1, 1.1); } div."+albumClass+" div.bottomPic.fanOut {"+broserAnim.prefix+"transform: translateX("+b.slideBy+"px) translateY(10px) scale(1.1, 1.1) rotate("+b.rotateBy+"deg); } ")}$selector.each(function(){$this=a(this).css({display:"inline-block"});$this.html("");thisId=$this.attr("id");if(!thisId||thisId==""){thisId=plusifier.uniqid();$this.attr("id",thisId)}a.each(c,function(d,c){if(c.imgs.length>0){cacheIndex=plusifier.cacheCount();$albcont=a("<div />").attr("id",thisId+albContExt+cacheIndex).attr(dataPlusifyCacheIndex,cacheIndex).addClass("jqAlbum "+albumClass).css({width:containerWidth,height:containerHeight,backgroundColor:b.backgroundColor,margin:b.margin}).appendTo($this);$container=a("<div/>").attr("id",thisId+imgContExt+cacheIndex).attr(dataPlusifyCacheIndex,cacheIndex).addClass("jqAP").css({position:"relative",width:containerWidth,height:containerHeight,backgroundColor:b.backgroundColor,"float":"left"}).bind("mouseenter",{id:cacheIndex},plusifier.onMouseEnter).bind("mouseleave",{id:cacheIndex},plusifier.onMouserLeave).appendTo($albcont);limit=c.imgs.length>3?3:c.imgs.length;rndIds=[];for(count=0;count<limit;count++){if(limit==3)cssClass=count==0?"topPic":count==1?"middlePic":"bottomPic";else if(limit==2)cssClass=count==0?"topPic":"bottomPic";else cssClass="middlePic";$imgCont=a("<div />").attr("id",thisId+imgContExt+cacheIndex+divIdExt+count).attr(dataPlusifyCacheIndex,cacheIndex).addClass("jqIC "+imgDivClass+" "+cssClass).css({width:imgWidth-count*4,height:imgHeight-count*4,top:-count*(imgHeight-(count-1)*2+10),left:count*6,"z-index":limit-count}).appendTo($container);if(b.randomize){isuniq=false;while(!isuniq){isuniq=true;at=Math.floor(Math.random()*c.imgs.length);a.each(rndIds,function(b,a){if(at==a)isuniq=false})}rndIds.push(at)}else at=count;$img=a("<img />").attr("id",thisId+imgContExt+cacheIndex+divIdExt+imgIdExt+count).attr("alt","").attr("src",c.imgs[at]).attr(dataPlusifyCacheIndex,cacheIndex).css({position:"relative",width:imgWidth-count*4,height:imgHeight-count*4}).appendTo($imgCont)}if(b.displayLabel)$lblDiv=a("<div />").attr("id",thisId+albContExt+lblExt+cacheIndex).attr(dataPlusifyCacheIndex,cacheIndex).addClass("jqAN "+labelClass).html(c.name).appendTo($albcont);$topImg=a("div.topPic",$container);$midImg=a("div.middlePic",$container);$botImg=a("div.bottomPic",$container);plusifier.newCache({elem:$container,topImg:$topImg.length>0?$topImg:null,midImg:$midImg.length>0?$midImg:null,botImg:$botImg.length>0?$botImg:null,topImgOrigPosit:$topImg.length>0?$topImg.position():null,album:c})}});if(b.displayLabel){height=0;a("div.jqAN").each(function(){$albInfo=a(this);height=$albInfo.height()>height?$albInfo.height():height});a("div.jqAlbum").each(function(){a(this).css("height",containerHeight+height+paddingVal)})}})}}})})(jQuery)